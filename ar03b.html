<html>
<head>
  <title>AR with Capture Button</title>
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  <script src="https://cdn.rawgit.com/donmccurdy/aframe-extras/v4.2.0/dist/aframe-extras.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
  <style>
    /* 撮影ボタンのスタイルを設定 */
    #captureButton {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 999;
    }
  </style>
</head>
<body style="margin: 0; overflow: hidden">

  <a-scene embedded arjs vr-mode-ui="enabled: false">
    <a-entity position="1.5 -1.5 -2" rotation="0 0 0">
      <a-gltf-model src="kyoju003.glb" position="0 0 0" animation-mixer></a-gltf-model>
    </a-entity>
    <a-entity camera></a-entity>
  </a-scene>

  <!-- 撮影ボタンを追加 -->
  <button id="captureButton">撮影</button>

  <script>
    // glTFの表示が暗くなる問題に対処
    document.querySelector("a-scene").renderer.gammaOutput = true;

    // 撮影ボタンのクリックハンドラを設定
    document.getElementById("captureButton").addEventListener("click", function () {
      // キャプチャロジックをここに追加
      captureScreenshot();
    });

    // スクリーンショットをキャプチャする関数
    function captureScreenshot() {
      // A-Frameのcanvasを取得
      const canvas = document.querySelector("canvas");

      // キャンバスのサイズを設定
      const width = canvas.width;
      const height = canvas.height;

      // キャンバスからデータURLを取得
      const dataURL = canvas.toDataURL("image/png");

      // データURLを使って新しいウィンドウで画像を表示
      const newWindow = window.open();
      newWindow.document.write('<img width="' + width + '" height="' + height + '" src="' + dataURL + '" alt="AR Screenshot"/>');
    }
  </script>
</body>
</html>
